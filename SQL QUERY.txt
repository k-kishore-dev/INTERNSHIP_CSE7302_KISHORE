SELECT DISTINCT
    PAPF.PERSON_NUMBER,
    PPNF.FIRST_NAME,
    PPNF.LAST_NAME,
    PPOS.DATE_START,
    PPOS.ACTUAL_TERMINATION_DATE AS TERMINATION_DATE,
    (PPOS.ACTUAL_TERMINATION_DATE - PPOS.DATE_START) AS DAYS_SERVED,
    PJFTL.NAME AS JOB_NAME,
    HROUFTL.NAME AS DEPT_NAME,
    PP.PHONE_NUMBER,
    PEA.EMAIL_ADDRESS,
    PAAM.ACTION_CODE AS TERMINATION_ACTION,
    PAAM.REASON_CODE AS TERMINATION_REASON


FROM
    PER_ALL_PEOPLE_F PAPF


JOIN PER_ALL_ASSIGNMENTS_M PAAM 
    ON PAPF.PERSON_ID = PAAM.PERSON_ID

JOIN PER_PERSON_NAMES_F PPNF 
    ON PAPF.PERSON_ID = PPNF.PERSON_ID

JOIN PER_PERIODS_OF_SERVICE PPOS 
    ON PPNF.PERSON_ID = PPOS.PERSON_ID

JOIN PER_JOBS_F_TL PJFTL 
    ON PAAM.JOB_ID = PJFTL.JOB_ID

JOIN HR_ORGANIZATION_UNITS_F_TL HROUFTL 
    ON PAAM.ORGANIZATION_ID = HROUFTL.ORGANIZATION_ID

JOIN PER_PHONES PP 
    ON PAPF.PERSON_ID = PP.PERSON_ID

JOIN PER_EMAIL_ADDRESSES PEA 
    ON PAPF.PERSON_ID = PEA.PERSON_ID


WHERE 
 PPNF.NAME_TYPE='GLOBAL'
   AND  PPOS.ACTUAL_TERMINATION_DATE BETWEEN :P_START_DATE AND :P_END_DATE
    AND (:P_PERSON_NUMBER IS NULL OR PAPF.PERSON_NUMBER = :P_PERSON_NUMBER)